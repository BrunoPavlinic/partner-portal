<div class="partner-table-container">
    @if (tableState.loading) {
        <div class="loading-spinner">
            <mat-spinner diameter="40"></mat-spinner>
        </div>
    }

    @if (tableState.error) {
        <div class="error-message">
            {{ tableState.error }}
        </div>
    }

    @if (!tableState.loading && !tableState.error) {
        <div class="table-wrapper">
            <table mat-table [dataSource]="partners" matSort (matSortChange)="onSortChange($event)">
                <!-- ID Column -->
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
                    <td mat-cell *matCellDef="let partner"> {{partner.id}} </td>
                </ng-container>
                <!-- Partner Name Column -->
                <ng-container matColumnDef="partnerName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Name </th>
                    <td mat-cell *matCellDef="let partner"> {{partner.partnerName}} </td>
                </ng-container>

                <!-- Partner Type Column -->
                <ng-container matColumnDef="partnerType">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Type </th>
                    <td mat-cell *matCellDef="let partner"> {{partner.partnerType}} </td>
                </ng-container>

                <!-- Contract Column -->
                <ng-container matColumnDef="contract">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Contract </th>
                    <td mat-cell *matCellDef="let partner"> {{partner.contract}} </td>
                </ng-container>

                <!-- Gross Sales Column -->
                <ng-container matColumnDef="grosssales">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Gross Sales </th>
                    <td mat-cell *matCellDef="let partner"> {{formatCurrency(partner.grosssales)}} </td>
                </ng-container>

                <!-- Commissions Column -->
                <ng-container matColumnDef="commissions">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Commissions </th>
                    <td mat-cell *matCellDef="let partner"> {{formatCurrency(partner.commissions)}} </td>
                </ng-container>

                <!-- Conversions Column -->
                <ng-container matColumnDef="conversions">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Conversions </th>
                    <td mat-cell *matCellDef="let partner"> {{partner.conversions}} </td>
                </ng-container>

                <!-- Actions Column -->
                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef></th>
                    <td mat-cell *matCellDef="let partner">
                        <button mat-button class="details-button" (click)="onPartnerDetails()">
                            <mat-icon>list</mat-icon>
                            <span>Details</span>
                        </button>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>

            <mat-paginator
                [length]="tableState.totalItems"
                [pageSize]="tableState.pageSize"
                [pageIndex]="tableState.currentPage - 1"
                (page)="onPageChange($event)"
                [pageSizeOptions]="[5, 10, 15, 20]"
                showFirstLastButtons>
            </mat-paginator>
        </div>
    }
</div> 